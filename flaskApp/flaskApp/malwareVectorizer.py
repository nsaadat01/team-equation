import os
import pandas as pd
from sklearn.feature_extraction.text import CountVectorizer

path = ''
labels = []
text = []

for filename in os.listdir(path):
    if filename == ".DS_Store":
        continue  # Skip the .DS_Store file
    if "Good" in filename:
        labels.append("1")
    else:
        labels.append("-1")
    filename = os.path.join(path, filename)
    print(filename)
    
    try:
        with open(filename, encoding='utf-8') as f:
            content = f.read()
    except UnicodeDecodeError:
        with open(filename, encoding='latin1') as f:
            content = f.read()

    content = content.replace(",", " ").replace('"', " ")
    text.append(content) 

vectorizer = CountVectorizer(stop_words='english', max_features=2500)

dtm = vectorizer.fit_transform(text)

df = pd.DataFrame(dtm.toarray(), index=labels, columns=vectorizer.get_feature_names_out())
df.index.name = "labels"

df.to_csv(r'Filtered_DynamicMalwareMatrix.csv')